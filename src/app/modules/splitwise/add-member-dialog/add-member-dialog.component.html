<!-- Mobile Header -->
<app-common-header
	[title]="'Add Member'"
	(closeButtonClick)="onCancel()"
	(addButtonClick)="onSubmit()"
	[isSubmitting]="isSubmitting"
	[showCloseButton]="true"
	[showAddButton]="true"
></app-common-header>

<app-common-body-content>
	<form [formGroup]="memberForm" (ngSubmit)="onSubmit()" class="member-form">
		<!-- Email Field -->
		<div class="form-field">
			<label class="field-label">
				<mat-icon class="field-icon">email</mat-icon>
				Email Address *
			</label>
			<input type="email" formControlName="email" placeholder="Enter member's email address" (input)="onEmailChange()" autofocus class="form-input" />
			<div class="field-footer">
				@if(memberForm.get('email')?.hasError('required') && memberForm.get('email')?.touched) {
				<p class="error-message">Email is required</p>
				} @if(memberForm.get('email')?.hasError('email') && memberForm.get('email')?.touched) {
				<p class="error-message">Please enter a valid email address</p>
				} @if(memberForm.get('email')?.hasError('alreadyMember') && memberForm.get('email')?.touched) {
				<p class="error-message">This person is already a member of the group</p>
				} @if(getUserStatusText()) {
				<p class="status-message" [class.user-found]="userExists" [class.user-not-found]="!userExists && !checkingUser">
					{{ getUserStatusText() }}
				</p>
				}
			</div>
		</div>

		<!-- Current Members Section -->
		<div class="form-field">
			<label class="field-label">
				<mat-icon class="field-icon">people</mat-icon>
				Current Members ({{ group.members.length }})
			</label>
			<div class="members-list">
				<div *ngFor="let member of group.members" class="member-item">
					<div class="member-avatar">
						<img *ngIf="member.photoURL" [src]="member.photoURL" [alt]="member.displayName" />
						<mat-icon *ngIf="!member.photoURL">person</mat-icon>
					</div>
					<div class="member-details">
						<span class="member-name">{{ member.displayName }}</span>
						<span class="member-email">{{ member.email }}</span>
					</div>
					<!-- delete member -->
					<button mat-icon-button (click)="onDeleteMember(member.userId)">
						<mat-icon>delete</mat-icon>
					</button>
				</div>
			</div>
		</div>

		<!-- Bottom Spacing for Mobile -->
		<div class="bottom-spacing"></div>
	</form>
</app-common-body-content>

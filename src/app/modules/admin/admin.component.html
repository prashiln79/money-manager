<div class="admin-container">
  <!-- Loading State -->
  <div *ngIf="!isAdmin" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Checking admin access...</p>
  </div>

  <!-- Admin Panel -->
  <div *ngIf="isAdmin" class="admin-panel">
    <!-- Header -->
    <header class="admin-header">
      <div class="header-content">
        <div class="header-left">
          <button mat-icon-button (click)="goToDashboard()" class="back-button" matTooltip="Back to Dashboard">
            <mat-icon>arrow_back</mat-icon>
          </button>
          <button mat-icon-button (click)="toggleSidebar()" class="menu-toggle" matTooltip="Toggle Menu" *ngIf="isMobile">
            <mat-icon>menu</mat-icon>
          </button>
          <div class="header-title">
            <h1>Admin Panel</h1>
            <p>Manage your Money Manager application</p>
          </div>
        </div>
        <div class="header-right">
          <div class="user-info">
            <mat-icon>admin_panel_settings</mat-icon>
            <span>{{ currentUser?.displayName || currentUser?.email }}</span>
          </div>
          <button mat-icon-button (click)="logout()" matTooltip="Logout">
            <mat-icon>logout</mat-icon>
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <div class="admin-content">
      <!-- Mobile Overlay -->
      <div *ngIf="isMobile && isSidebarOpen" class="mobile-overlay" (click)="closeSidebar()"></div>
      
      <!-- Sidebar Navigation -->
      <aside class="admin-sidebar" [class.mobile-sidebar]="isMobile" [class.open]="isSidebarOpen">
        <div class="sidebar-header">
          <h3>Admin Navigation</h3>
        </div>
        
        <nav class="sidebar-nav">
          <!-- Iterate through admin sections -->
          <div *ngFor="let section of adminSections" class="nav-section">
            <!-- Section Header -->
            <div 
              class="section-header"
              [class.collapsible]="section.isCollapsible"
              (click)="section.isCollapsible ? toggleSection(section.id) : null"
            >
              <div class="section-icon">
                <mat-icon>{{ section.icon }}</mat-icon>
              </div>
              <div class="section-content">
                <span class="section-label">{{ section.label }}</span>
              </div>
              <div class="section-toggle" *ngIf="section.isCollapsible">
                <mat-icon>{{ isSectionExpanded(section.id) ? 'expand_less' : 'expand_more' }}</mat-icon>
              </div>
            </div>

            <!-- Section Items -->
            <div class="section-items" [class.expanded]="isSectionExpanded(section.id)">
              <div 
                *ngFor="let item of getSectionItems(section.id)"
                class="nav-item"
                [class.active]="activeSection === item.id"
                (click)="setActiveSection(item.id)"
                matTooltip="{{ item.description }}"
              >
                <div class="nav-icon">
                  <mat-icon>{{ item.icon }}</mat-icon>
                </div>
                <div class="nav-content">
                  <span class="nav-label">{{ item.label }}</span>
                  <span class="nav-description">{{ item.description }}</span>
                </div>
                <div class="nav-indicator" *ngIf="activeSection === item.id">
                  <mat-icon>chevron_right</mat-icon>
                </div>
                <div class="nav-badge" *ngIf="item.badge">
                  <span class="badge" [class]="'badge-' + item.badge.color">
                    {{ item.badge.text }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </nav>

        <!-- Sidebar Footer -->
        <div class="sidebar-footer">
          <div class="admin-status">
            <mat-icon class="status-icon">verified_user</mat-icon>
            <span>Admin Access</span>
          </div>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="main-content">
        <!-- Breadcrumb -->
        <div class="breadcrumb">
          <span class="breadcrumb-item">Admin</span>
          <mat-icon>chevron_right</mat-icon>
          <span class="breadcrumb-item active">{{ getActiveSectionLabel() }}</span>
        </div>

        <!-- Dashboard Section -->
        <div *ngIf="activeSection === 'dashboard'" class="dashboard-section">
          <div class="section-header">
            <h2>Dashboard Overview</h2>
            <p>Key metrics and statistics for your application</p>
          </div>

          <!-- Statistics Cards -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon users">
                <mat-icon>people</mat-icon>
              </div>
              <div class="stat-content">
                <h3>{{ dashboardStats.totalUsers }}</h3>
                <p>Total Users</p>
                <span class="stat-trend positive">+12% this month</span>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon feedback">
                <mat-icon>feedback</mat-icon>
              </div>
              <div class="stat-content">
                <h3>{{ dashboardStats.totalFeedback }}</h3>
                <p>Total Feedback</p>
                <span class="stat-trend positive">+8% this week</span>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon pending">
                <mat-icon>pending</mat-icon>
              </div>
              <div class="stat-content">
                <h3>{{ dashboardStats.pendingFeedback }}</h3>
                <p>Pending Feedback</p>
                <span class="stat-trend neutral">Requires attention</span>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon active">
                <mat-icon>trending_up</mat-icon>
              </div>
              <div class="stat-content">
                <h3>{{ dashboardStats.activeUsers }}</h3>
                <p>Active Users</p>
                <span class="stat-trend positive">+15% this month</span>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon transactions">
                <mat-icon>receipt_long</mat-icon>
              </div>
              <div class="stat-content">
                <h3>{{ dashboardStats.totalTransactions }}</h3>
                <p>Total Transactions</p>
                <span class="stat-trend positive">+22% this month</span>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon categories">
                <mat-icon>category</mat-icon>
              </div>
              <div class="stat-content">
                <h3>{{ dashboardStats.totalCategories }}</h3>
                <p>Total Categories</p>
                <span class="stat-trend neutral">Stable</span>
              </div>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="quick-actions">
            <h3>Quick Actions</h3>
            <div class="actions-grid">
              <button mat-raised-button color="primary" (click)="setActiveSection('feedback')" class="action-button">
                <mat-icon>feedback</mat-icon>
                <div class="action-content">
                  <span class="action-title">View Feedback</span>
                  <span class="action-subtitle">Manage user feedback</span>
                </div>
              </button>
              <button mat-raised-button color="accent" (click)="setActiveSection('users')" class="action-button">
                <mat-icon>people</mat-icon>
                <div class="action-content">
                  <span class="action-title">Manage Users</span>
                  <span class="action-subtitle">User account management</span>
                </div>
              </button>
              <button mat-raised-button color="warn" (click)="setActiveSection('analytics')" class="action-button">
                <mat-icon>analytics</mat-icon>
                <div class="action-content">
                  <span class="action-title">View Analytics</span>
                  <span class="action-subtitle">App usage statistics</span>
                </div>
              </button>
              <button mat-raised-button color="primary" (click)="setActiveSection('settings')" class="action-button">
                <mat-icon>settings</mat-icon>
                <div class="action-content">
                  <span class="action-title">Admin Settings</span>
                  <span class="action-subtitle">Configuration options</span>
                </div>
              </button>
            </div>
          </div>
        </div>

        <!-- Feedback Section -->
        <div *ngIf="activeSection === 'feedback'" class="feedback-section">
          <div class="section-header">
            <h2>User Feedback Management</h2>
            <p>View and manage user feedback and suggestions</p>
          </div>
          <app-admin-feedback></app-admin-feedback>
        </div>

        <!-- Users Section -->
        <div *ngIf="activeSection === 'users'" class="users-section">
          <div class="section-header">
            <h2>User Management</h2>
            <p>Manage user accounts, roles, and permissions</p>
          </div>
          <app-admin-users></app-admin-users>
        </div>

        <!-- Analytics Section -->
        <div *ngIf="activeSection === 'analytics'" class="analytics-section">
          <div class="section-header">
            <h2>Analytics Dashboard</h2>
            <p>Comprehensive analytics and insights</p>
          </div>
          <app-admin-analytics></app-admin-analytics>
        </div>

        <!-- Settings Section -->
        <div *ngIf="activeSection === 'settings'" class="settings-section">
          <div class="section-header">
            <h2>Admin Settings</h2>
            <p>Configure application settings and preferences</p>
          </div>
          <app-admin-settings></app-admin-settings>
        </div>
      </main>
    </div>
  </div>
</div> 
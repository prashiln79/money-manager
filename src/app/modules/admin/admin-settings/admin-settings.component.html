<div class="settings-container">
  <div class="section-header">
    <h2>Admin Settings</h2>
    <p>Configure application settings and preferences</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Loading settings...</p>
  </div>

  <!-- Settings Content -->
  <div *ngIf="!isLoading" class="settings-content">
    <form [formGroup]="settingsForm" (ngSubmit)="saveSettings()">
      <!-- Settings Navigation -->
      <div class="settings-nav">
        <div 
          *ngFor="let category of settingsCategories"
          class="nav-item"
          [class.active]="activeCategory === category.id"
          (click)="setActiveCategory(category.id)"
        >
          <mat-icon>{{ category.icon }}</mat-icon>
          <div class="nav-content">
            <span class="nav-label">{{ category.label }}</span>
            <span class="nav-description">{{ category.description }}</span>
          </div>
        </div>
      </div>

      <!-- Settings Form -->
      <div class="settings-form">
        <!-- General Settings -->
        <div *ngIf="activeCategory === 'general'" class="settings-section">
          <h3>General Settings</h3>
          
          <div class="form-group">
            <label for="appName">Application Name</label>
            <input 
              id="appName"
              type="text" 
              formControlName="appName"
              [class.invalid]="isFormControlInvalid('appName')"
              placeholder="Enter application name"
            >
            <div *ngIf="isFormControlInvalid('appName')" class="error-message">
              Application name is required and must be at least 2 characters
            </div>
          </div>

          <div class="form-group">
            <label for="appVersion">Application Version</label>
            <input 
              id="appVersion"
              type="text" 
              formControlName="appVersion"
              [class.invalid]="isFormControlInvalid('appVersion')"
              placeholder="e.g., 1.0.0"
            >
            <div *ngIf="isFormControlInvalid('appVersion')" class="error-message">
              Version is required
            </div>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="maintenanceMode">
              <span class="checkmark"></span>
              Enable Maintenance Mode
            </label>
            <p class="help-text">When enabled, users will see a maintenance page</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="userRegistrationEnabled">
              <span class="checkmark"></span>
              Enable User Registration
            </label>
            <p class="help-text">Allow new users to register accounts</p>
          </div>
        </div>

        <!-- Security Settings -->
        <div *ngIf="activeCategory === 'security'" class="settings-section">
          <h3>Security Settings</h3>
          
          <div class="form-group">
            <label for="sessionTimeout">Session Timeout (minutes)</label>
            <input 
              id="sessionTimeout"
              type="number" 
              formControlName="sessionTimeout"
              [class.invalid]="isFormControlInvalid('sessionTimeout')"
              min="5" max="120"
            >
            <div *ngIf="isFormControlInvalid('sessionTimeout')" class="error-message">
              Session timeout must be between 5 and 120 minutes
            </div>
          </div>

          <div class="form-group">
            <label for="maxLoginAttempts">Maximum Login Attempts</label>
            <input 
              id="maxLoginAttempts"
              type="number" 
              formControlName="maxLoginAttempts"
              [class.invalid]="isFormControlInvalid('maxLoginAttempts')"
              min="3" max="10"
            >
            <div *ngIf="isFormControlInvalid('maxLoginAttempts')" class="error-message">
              Login attempts must be between 3 and 10
            </div>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="requireEmailVerification">
              <span class="checkmark"></span>
              Require Email Verification
            </label>
            <p class="help-text">Users must verify their email before accessing the app</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="enableTwoFactor">
              <span class="checkmark"></span>
              Enable Two-Factor Authentication
            </label>
            <p class="help-text">Allow users to enable 2FA for additional security</p>
          </div>
        </div>

        <!-- Notification Settings -->
        <div *ngIf="activeCategory === 'notifications'" class="settings-section">
          <h3>Notification Settings</h3>
          
          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="emailNotificationsEnabled">
              <span class="checkmark"></span>
              Enable Email Notifications
            </label>
            <p class="help-text">Send email notifications to users</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="pushNotificationsEnabled">
              <span class="checkmark"></span>
              Enable Push Notifications
            </label>
            <p class="help-text">Send push notifications to mobile devices</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="feedbackNotificationsEnabled">
              <span class="checkmark"></span>
              Feedback Notifications
            </label>
            <p class="help-text">Notify admins when new feedback is submitted</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="adminNotificationsEnabled">
              <span class="checkmark"></span>
              Admin Notifications
            </label>
            <p class="help-text">Send notifications to admin users</p>
          </div>
        </div>

        <!-- Performance Settings -->
        <div *ngIf="activeCategory === 'performance'" class="settings-section">
          <h3>Performance Settings</h3>
          
          <div class="form-group">
            <label for="maxFileUploadSize">Maximum File Upload Size (MB)</label>
            <input 
              id="maxFileUploadSize"
              type="number" 
              formControlName="maxFileUploadSize"
              [class.invalid]="isFormControlInvalid('maxFileUploadSize')"
              min="1" max="50"
            >
            <div *ngIf="isFormControlInvalid('maxFileUploadSize')" class="error-message">
              File size must be between 1 and 50 MB
            </div>
          </div>

          <div class="form-group">
            <label for="backupFrequency">Backup Frequency</label>
            <select 
              id="backupFrequency"
              formControlName="backupFrequency"
              [class.invalid]="isFormControlInvalid('backupFrequency')"
            >
              <option value="daily">Daily</option>
              <option value="weekly">Weekly</option>
              <option value="monthly">Monthly</option>
            </select>
            <div *ngIf="isFormControlInvalid('backupFrequency')" class="error-message">
              Backup frequency is required
            </div>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="analyticsEnabled">
              <span class="checkmark"></span>
              Enable Analytics
            </label>
            <p class="help-text">Collect usage analytics and statistics</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="debugMode">
              <span class="checkmark"></span>
              Debug Mode
            </label>
            <p class="help-text">Enable debug logging and development features</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="cacheEnabled">
              <span class="checkmark"></span>
              Enable Caching
            </label>
            <p class="help-text">Cache data for improved performance</p>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="compressionEnabled">
              <span class="checkmark"></span>
              Enable Compression
            </label>
            <p class="help-text">Compress responses for faster loading</p>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
          <button 
            type="button" 
            class="btn btn-secondary"
            (click)="resetSettings()"
            [disabled]="isSaving"
          >
            Reset
          </button>
          
          <div class="action-group">
            <button 
              type="button" 
              class="btn btn-outline"
              (click)="exportSettings()"
              [disabled]="isSaving"
            >
              <mat-icon>download</mat-icon>
              Export
            </button>
            
            <label class="btn btn-outline import-btn">
              <mat-icon>upload</mat-icon>
              Import
              <input 
                type="file" 
                accept=".json"
                (change)="importSettings($event)"
                style="display: none;"
              >
            </label>
          </div>
          
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="settingsForm.invalid || isSaving"
          >
            <mat-spinner *ngIf="isSaving" diameter="20"></mat-spinner>
            <span *ngIf="!isSaving">Save Settings</span>
            <span *ngIf="isSaving">Saving...</span>
          </button>
        </div>
      </div>
    </form>
  </div>
</div> 
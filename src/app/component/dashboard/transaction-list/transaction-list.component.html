@if (isMobile) {
<mobile-transaction-list
  [transactions]="allTransactions"
  [searchTerm]="searchTerm"
  [selectedCategory]="selectedCategory"
  [selectedType]="selectedType"
  [selectedDate]="selectedDate"
  [selectedDateRange]="selectedDateRange"
  (editTransaction)="editTransaction($event)"
  (deleteTransaction)="deleteTransaction($event)"
  (addTransaction)="addTransactionDialog()"
  (importTransactions)="openImportDialog()">
</mobile-transaction-list>

} @else {

<mat-card class="p-6 shadow-lg border-0 rounded-xl transaction-list-container max-h-[91vh]">
	<mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" class="custom-tabs">
		<mat-tab class="max-h-full">
			<ng-template mat-tab-label>
				<div class="flex items-center space-x-2 px-4 py-2">
					<mat-icon class="text-primary">compare_arrows</mat-icon>
					<span class="font-semibold text-gray-700">Transactions</span>
				</div>
			</ng-template>

			<div class="p-6 max-h-[76vh] overflow-hidden">

				<!-- Search and Filter Section -->
				<div class="bg-white rounded-lg border border-gray-200 p-4 mb-4">
					<!-- Transaction Count -->
					<div class="flex items-center justify-between mb-4 pb-3 border-b border-gray-100">
						<div class="flex items-center space-x-2">
							<mat-icon class="text-gray-500 text-sm">receipt_long</mat-icon>
							<span class="text-sm text-gray-600">
								{{ getCurrentYear() }} Transactions: <span class="font-semibold text-gray-800">{{ getFilteredCount() }}</span>
								<span *ngIf="getFilteredCount() !== getCurrentYearCount()" class="text-gray-400">/{{ getCurrentYearCount() }}</span>
							</span>
						</div>
						<div class="flex items-center space-x-2">
							<button mat-icon-button class="bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-lg transition-colors" matTooltip="Import transactions" (click)="openImportDialog()">
								<mat-icon>file_upload</mat-icon>
							</button>
							<button mat-icon-button class="bg-green-50 hover:bg-green-100 text-green-600 rounded-lg transition-colors" matTooltip="Add transaction" (click)="addTransactionDialog()">
								<mat-icon>add</mat-icon>
							</button>
						</div>
					</div>
					<div class="grid grid-cols-1 md:grid-cols-4 gap-4">
						<!-- Search Input -->
						<div class="relative col-span-2">
							<mat-icon class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">search</mat-icon>
							<input
								type="text"
								[(ngModel)]="searchTerm"
								(input)="onSearchChange()"
								placeholder="Search transactions..."
								class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
							/>
						</div>

						<!-- Category Filter -->
						<div>
							<select
								[(ngModel)]="selectedCategory"
								(change)="onCategoryChange()"
								class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
							>
								<option value="all">All Categories</option>
								<option *ngFor="let category of getCategoriesList()" [value]="category">
									{{ category }}
								</option>
							</select>
						</div>

						<!-- Type Filter -->
						<div>
							<select
								[(ngModel)]="selectedType"
								(change)="onTypeChange()"
								class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
							>
								<option value="all">All Types</option>
								<option value="income">Income</option>
								<option value="expense">Expense</option>
							</select>
						</div>

						<!-- Clear Filters Button -->
						<div class="flex space-x-2">
							<!-- <button mat-icon-button class="bg-white hover:bg-gray-50 border border-gray-200 rounded-lg" matTooltip="Refresh transactions" (click)="refreshTransactions()">
								<mat-icon class="text-gray-600">refresh</mat-icon>
							</button> -->
							<button mat-icon-button class="bg-white hover:bg-gray-50 border border-gray-200 rounded-lg" matTooltip="Filter transactions" (click)="openFilterDialog()">
								<mat-icon class="text-gray-600">filter_list</mat-icon>
							</button>
							<button mat-icon-button class="bg-white hover:bg-gray-50 border border-gray-200 rounded-lg" matTooltip="View analytics" (click)="viewAnalytics()">
								<mat-icon class="text-gray-600">analytics</mat-icon>
							</button>
							<button mat-icon-button class="bg-white hover:bg-gray-50 border border-gray-200 rounded-lg" matTooltip="Expand table" (click)="expandTable()">
								<mat-icon class="text-gray-600">open_in_new</mat-icon>
							</button>
							<button
								*ngIf="selectedDate || selectedDateRange || searchTerm || selectedCategory !== 'all' || selectedType !== 'all'"
								mat-icon-button
								class="bg-red-50 hover:bg-red-100 border border-red-200 rounded-lg"
								matTooltip="Clear all filters"
								(click)="clearAllFilters()"
							>
								<mat-icon class="text-red-600">clear</mat-icon>
							</button>
						</div>
					</div>
				</div>

				<!-- Table Container -->
				<transaction-table
					[transactions]="allTransactions"
					[searchTerm]="searchTerm"
					[selectedCategory]="selectedCategory"
					[selectedType]="selectedType"
					[selectedDate]="selectedDate"
					[selectedDateRange]="selectedDateRange"
					(editTransaction)="editTransaction($event)"
					(deleteTransaction)="deleteTransaction($event)"
					(startRowEdit)="startRowEdit($event)"
					(saveRowEdit)="saveRowEdit($event)"
					(cancelRowEdit)="cancelRowEdit($event)"
					(addTransaction)="addTransactionDialog()">
				</transaction-table>
			</div>
		</mat-tab>
		<mat-tab>
			<ng-template mat-tab-label>
				<div class="flex items-center space-x-2 px-4 py-2">
					<mat-icon class="text-primary">attach_money</mat-icon>
					<span class="font-semibold text-gray-700">Accounts</span>
				</div>
			</ng-template>
			<div class="p-6">
				<div class="flex justify-between items-center mb-6">
					<div>
						<h2 class="text-2xl font-bold text-gray-800 mb-1">Account Management</h2>
						<p class="text-gray-600">Manage your bank accounts and financial institutions</p>
					</div>
					<button mat-raised-button color="primary" class="flex items-center space-x-2">
						<mat-icon>add</mat-icon>
						<span>Add Account</span>
					</button>
				</div>
				<user-accounts></user-accounts>
			</div>
		</mat-tab>

		<mat-tab>
			<ng-template mat-tab-label>
				<div class="flex items-center space-x-2 px-4 py-2">
					<mat-icon class="text-primary">local_offer</mat-icon>
					<span class="font-semibold text-gray-700">Categories</span>
				</div>
			</ng-template>
			<div class="p-6">
				<div class="flex justify-between items-center mb-6">
					<div>
						<h2 class="text-2xl font-bold text-gray-800 mb-1">Transaction Categories</h2>
						<p class="text-gray-600">Organize your transactions with custom categories</p>
					</div>
					<button mat-raised-button color="primary" class="flex items-center space-x-2">
						<mat-icon>add</mat-icon>
						<span>Add Category</span>
					</button>
				</div>
				<transaction-category></transaction-category>
			</div>
		</mat-tab>

		<mat-tab>
			<ng-template mat-tab-label>
				<div class="flex items-center space-x-2 px-4 py-2">
					<mat-icon class="text-primary">analytics</mat-icon>
					<span class="font-semibold text-gray-700">Reports</span>
				</div>
			</ng-template>
			<app-reports></app-reports>
		</mat-tab>

		<mat-tab>
			<ng-template mat-tab-label>
				<div class="flex items-center space-x-2 px-4 py-2">
					<mat-icon class="text-primary">receipt_long</mat-icon>
					<span class="font-semibold text-gray-700">Tax</span>
				</div>
			</ng-template>
			<app-tax></app-tax>
		</mat-tab>

		<mat-tab>
			<ng-template mat-tab-label>
				<div class="flex items-center space-x-2 px-4 py-2">
					<mat-icon class="text-yellow-600">note</mat-icon>
					<span class="font-semibold text-gray-700">Notes</span>
				</div>
			</ng-template>
			<app-notes></app-notes>
		</mat-tab>
	</mat-tab-group>
</mat-card>
}

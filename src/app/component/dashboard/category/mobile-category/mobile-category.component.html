<!-- Mobile Header -->
<div class="sticky top-0 z-20 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm">
  <div class="flex items-center justify-between px-4 py-3">
    <h6 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
      {{ dialogData?.id ? 'Edit' : 'Add' }} Category
    </h6>
    <div class="flex items-center gap-2">
      <!-- Save Button -->
      <button 
        mat-icon-button 
        color="primary" 
        (click)="onSubmit()" 
        [disabled]="categoryForm.invalid || isSubmitting" 
        matTooltip="Save Category" 
        class="w-10 h-10 !bg-primary"
      >
        <mat-icon class="text-white">
          {{ isSubmitting ? 'hourglass_empty' : 'check' }}
        </mat-icon>
      </button>

      <!-- Close Button -->
      <button 
        mat-icon-button 
        type="button" 
        (click)="onClose()" 
        matTooltip="Close" 
        class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
      >
        <mat-icon>close</mat-icon>
      </button>
    </div>
  </div>
</div>

<!-- Mobile Form Content -->
<div class="flex-1 overflow-y-auto bg-gray-50 dark:bg-gray-900">
  <div class="p-4 space-y-6">
    <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()" class="space-y-6">
      
      <!-- Category Name Field -->
      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm">
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
          Category Name *
        </label>
        <input 
          type="text" 
          formControlName="name" 
          placeholder="e.g., Groceries"
          maxlength="50"
          autofocus
          class="w-full py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        />
        <div class="flex justify-between items-center mt-1">
          @if(getNameError() && categoryForm.get('name')?.touched) {
            <p class="text-red-500 text-sm">{{ getNameError() }}</p>
          }
          <span class="text-xs text-gray-500">
            {{ categoryForm.get('name')?.value?.length || 0 }}/50
          </span>
        </div>
      </div>

      <!-- Category Type Field -->
      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm">
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
          Category Type *
        </label>
        <select 
          formControlName="type" 
          class="w-full py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        >
          <option value="expense">Expense</option>
          <option value="income">Income</option>
        </select>
        @if(getTypeError() && categoryForm.get('type')?.touched) {
          <p class="text-red-500 text-sm mt-1">{{ getTypeError() }}</p>
        }
      </div>

      <!-- Category Icon Field -->
      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm">
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
          Category Icon *
        </label>
        <div class="icon-selector">
          <button type="button"
                  (click)="toggleIconPicker()"
                  class="w-full py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent flex items-center justify-between"
                  [class.ring-2]="showIconPicker"
                  [class.ring-blue-500]="showIconPicker">
            <div class="flex items-center gap-3">
              <mat-icon>{{ categoryForm.get('icon')?.value || 'category' }}</mat-icon>
              <span class="text-gray-700 dark:text-gray-300">{{ categoryForm.get('icon')?.value || 'category' }}</span>
            </div>
            <mat-icon class="text-gray-400">expand_more</mat-icon>
          </button>
          
          <!-- Icon Picker Dropdown -->
          <div *ngIf="showIconPicker" 
               class="absolute z-50 mt-1 w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-64 overflow-y-auto"
               (clickOutside)="closeIconPicker()">
            <div class="p-3">
              <div class="grid grid-cols-6 gap-2">
                <button *ngFor="let icon of availableIcons"
                        type="button"
                        (click)="selectIcon(icon)"
                        class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center justify-center transition-colors"
                        [class.bg-blue-100]="categoryForm.get('icon')?.value === icon"
                        [class.text-blue-600]="categoryForm.get('icon')?.value === icon"
                        matTooltip="{{ icon }}">
                  <mat-icon class="text-lg">{{ icon }}</mat-icon>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bottom Spacing for Mobile -->
      <div class="h-20"></div>
    </form>
  </div>
</div> 
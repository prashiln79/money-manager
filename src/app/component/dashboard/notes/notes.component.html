<div class="p-6">
  <div class="flex justify-between items-center mb-6">
    <div>
      <h2 class="text-2xl font-bold text-gray-800 mb-1">Notes & Documents</h2>
      <p class="text-gray-600">Store and organize your financial notes, documents, and important information</p>
    </div>
    <div class="flex space-x-3">
      <button mat-stroked-button class="flex items-center space-x-2" (click)="importNotes()">
        <mat-icon>upload</mat-icon>
        <span>Import</span>
      </button>
      <button mat-stroked-button class="flex items-center space-x-2" (click)="exportNotes()">
        <mat-icon>download</mat-icon>
        <span>Export</span>
      </button>
      <button mat-raised-button color="primary" class="flex items-center space-x-2" (click)="addNote()">
        <mat-icon>add</mat-icon>
        <span>Add Note</span>
      </button>
    </div>
  </div>

  <!-- Search and Filter Section -->
  <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="relative">
      <mat-icon class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">search</mat-icon>
      <input 
        type="text" 
        placeholder="Search notes..."
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
        class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      >
    </div>
    <div>
      <select 
        [(ngModel)]="selectedCategory"
        (change)="onCategoryChange()"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      >
        <option *ngFor="let category of categories" [value]="category.value">
          {{ category.label }}
        </option>
      </select>
    </div>
  </div>

  <!-- Add Note Form -->
  <div *ngIf="isAddingNote" class="mb-6">
    <mat-card class="p-6 shadow-lg border-0 rounded-xl">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold text-gray-800">Add New Note</h3>
        <button mat-icon-button (click)="cancelAddNote()">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Title</label>
          <input 
            type="text" 
            [(ngModel)]="newNote.title"
            placeholder="Enter note title..."
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          >
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Content</label>
          <textarea 
            [(ngModel)]="newNote.content"
            placeholder="Enter note content..."
            rows="4"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          ></textarea>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
            <select 
              [(ngModel)]="newNote.category"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            >
              <option *ngFor="let category of categories.slice(1)" [value]="category.value">
                {{ category.label }}
              </option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
            <input 
              type="text" 
              placeholder="Add tags (comma separated)..."
              (keyup.enter)="addTag($event);"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            >
            <div class="flex flex-wrap gap-2 mt-2">
              <span 
                *ngFor="let tag of newNote.tags" 
                class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
              >
                {{ tag }}
                <button (click)="removeTag(tag)" class="ml-1 text-blue-600 hover:text-blue-800">
                  <mat-icon class="text-xs">close</mat-icon>
                </button>
              </span>
            </div>
          </div>
        </div>
        
        <div class="flex items-center">
          <mat-checkbox [(ngModel)]="newNote.isImportant" class="mr-2">
            Mark as Important
          </mat-checkbox>
        </div>
        
        <div class="flex justify-end space-x-3">
          <button mat-stroked-button (click)="cancelAddNote()">Cancel</button>
          <button mat-raised-button color="primary" (click)="saveNote()">Save Note</button>
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Notes List -->
  <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
    <div *ngFor="let note of filteredNotes" class="relative">
      <mat-card class="h-full shadow-lg border-0 rounded-xl hover:shadow-xl transition-shadow" 
                [class.border-l-4]="note.isImportant"
                [class.border-l-red-500]="note.isImportant">
        <div class="p-6">
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <h3 class="text-lg font-semibold text-gray-800 mb-1">{{ note.title }}</h3>
              <div class="flex items-center space-x-2 text-sm text-gray-500">
                <mat-icon class="text-xs">{{ getCategoryInfo(note.category).icon }}</mat-icon>
                <span>{{ getCategoryInfo(note.category).label }}</span>
                <span>â€¢</span>
                <span>{{ note.createdAt | date:'MMM dd, yyyy' }}</span>
              </div>
            </div>
            <div class="flex space-x-1">
              <button 
                mat-icon-button 
                [class.text-red-500]="note.isImportant"
                (click)="toggleImportant(note)"
                matTooltip="Mark as important"
              >
                <mat-icon>{{ note.isImportant ? 'star' : 'star_border' }}</mat-icon>
              </button>
              <button 
                mat-icon-button 
                color="warn"
                (click)="deleteNote(note.id)"
                matTooltip="Delete note"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
          
          <p class="text-gray-600 mb-4 line-clamp-3">{{ note.content }}</p>
          
          <div class="flex flex-wrap gap-2 mb-3">
            <span 
              *ngFor="let tag of note.tags" 
              class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700"
            >
              {{ tag }}
            </span>
          </div>
          
          <div class="text-xs text-gray-400">
            Last updated: {{ note.updatedAt | date:'MMM dd, yyyy HH:mm' }}
          </div>
        </div>
      </mat-card>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="filteredNotes.length === 0 && !isAddingNote" class="text-center py-12">
    <mat-icon class="text-gray-400 text-6xl mb-4">note</mat-icon>
    <h3 class="text-lg font-medium text-gray-900 mb-2">No notes found</h3>
    <p class="text-gray-500 mb-4">
      {{ searchTerm || selectedCategory !== 'all' ? 'Try adjusting your search or filter criteria.' : 'Start by adding your first note to keep track of important information.' }}
    </p>
    <button mat-raised-button color="primary" class="flex items-center space-x-2 mx-auto" (click)="addNote()">
      <mat-icon>add</mat-icon>
      <span>Add Note</span>
    </button>
  </div>
</div> 
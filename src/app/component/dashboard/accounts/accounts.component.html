<div class="accounts-container">
	<!-- Error Message Display -->
	<div *ngIf="errorMessage" class="error-message mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between">
		<p class="text-red-700 text-sm">{{ errorMessage }}</p>
		<button (click)="clearError()" class="text-red-500 hover:text-red-700 text-lg font-bold">
			Ã—
		</button>
	</div>

	<!-- Loading Indicator -->
	<!-- <div *ngIf="isLoading$ | async" class="loading-indicator flex justify-center items-center py-12">
		<mat-spinner diameter="32"></mat-spinner>
	</div> -->

	<!-- Main Content -->
	<div *ngIf="!(isLoading$ | async)" class="accounts-main">
		<!-- Header -->
		<div class="accounts-header">
			<div class="header-content">
				<h4 class="header-title">Your Accounts</h4>
				<p class="header-subtitle">({{ (accounts$ | async)?.length || 0 }} account{{ ((accounts$ | async)?.length || 0) !== 1 ? 's' : '' }})</p>
			</div>
			<button mat-fab color="primary" (click)="addAccount()" class="add-account-btn">
				<mat-icon>add</mat-icon>
			</button>
		</div>

		<!-- Empty State -->
		<div *ngIf="(accounts$ | async)?.length === 0" class="empty-state">
			<div class="empty-icon">ðŸ’³</div>
			<h3 class="empty-title">No accounts yet</h3>
			<p class="empty-text">Add your first account to get started</p>
			<button mat-raised-button 
					color="primary" 
					(click)="addAccount()"
					class="empty-action">
				<mat-icon>add</mat-icon>
				Add Account
			</button>
		</div>

		<!-- Accounts List -->
		<div *ngIf="(accounts$ | async) as accounts" class="accounts-list">
			<ng-container *ngIf="accounts$ | async as accounts">
				<div
					*ngFor="let account of accounts; trackBy: trackByAccountId"
					class="account-item"
					[class]="getBalanceClass(account)"
				>
					<div class="account-content">
						<div class="account-info">
							<div class="account-icon">
								<mat-icon>{{ getAccountIcon(account.type) }}</mat-icon>
							</div>
							<div class="account-details">
								<h3 class="account-name">{{ account.name }}</h3>
								
								@if(isLoanAccount(account)){
									<p class="account-type"><b>Interest Rate:</b> {{ getLoanDetails(account)?.interestRate +'%'  }}</p>
									<p class="account-type"><b>Next Due:</b> {{ getLoanDetails(account)?.nextDueDate | date:'MMM d, yyyy'  }}</p>
									<p class="account-type"><b>Monthly Interest:</b> {{ calculateMonthlyInterest(account) | currency  }}</p>
								}@else{
									<p class="account-type">{{ account.type  | titlecase }}</p>
								}
							</div>
						</div>
						
						<div class="account-balance" >
							<span class="balance-amount">{{ account.balance | currency }}</span>
						</div>

						<div class="account-menu">
							<button mat-icon-button [matMenuTriggerFor]="accountMenu" matTooltip="More options" class="menu-btn">
								<mat-icon>more_vert</mat-icon>
							</button>
							<mat-menu #accountMenu="matMenu">
								<button mat-menu-item (click)="editAccount(account)">
									<mat-icon>edit</mat-icon>
									<span>Edit Account</span>
								</button>
								<button mat-menu-item (click)="deleteAccount(account)" class="delete-menu-item">
									<mat-icon>delete</mat-icon>
									<span>Delete Account</span>
								</button>
							</mat-menu>
						</div>
					</div>

				
				</div>
			</ng-container>
		</div>
	</div>
</div>
